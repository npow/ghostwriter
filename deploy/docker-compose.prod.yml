services:
  ghostwriter:
    build:
      context: ..
      dockerfile: Dockerfile
    environment:
      - ANTHROPIC_BASE_URL=http://cliproxy:8317
      - ANTHROPIC_API_KEY=${CLIPROXY_API_KEY:-your-api-key-1}
    volumes:
      # SSH keys for git push to GitHub
      - ${HOME}/.ssh:/root/.ssh:ro
      # Hugo blog repo (ghostwriter writes posts and pushes)
      - ${HUGO_REPO_PATH:-/root/exitcloud.github.io}:/repos/exitcloud.github.io
      # Ghostwriter state (article history, connections)
      - ${HOME}/.ghostwriter:/root/.ghostwriter
    networks:
      - recon_default
    entrypoint: ["node", "packages/cli/dist/index.js", "run", "exitcloud"]

networks:
  recon_default:
    external: true
